c
modal_id
c
params[:movement]
c
params
modal_id
c
params
c
params
c
time_ranges
@year
Movement.where(year: @year).count
movements.count
movements.where(movement_type: 'out').count
c
movements.where(movement_type: 'out').count
movements.pluck(:year).uniq
movements.count.pluck(:year).uniq
movements.count
c
params[:q]
c
params[:q].to_unsafe_h
params[:q].parametes
params[:q].values
params[:q]
c
@time_range_report
c
q.keys - %w[emitted_at_gteq emitted_at_lteq]
blank_keys?(q, q.keys - %w[emitted_at_gteq emitted_at_lteq])
q[:emitted_at_lteq].present?
q[:emitted_at_gteq].present?
q.present?
q = params[:q]
@time_range_report
c
@time_range_report
c
hash[keys.first]
keys.first
keys
c
movements = movements.where(expense_item_id: expense_item.id)
expense_item = @movements_global_amount_by_expense_items.keys.second
time_range
c
movements = movements.where(expense_item_id: expense_item.id)
expense_item = @movements_global_amount_by_expense_items.keys.second
movements = movements.where(expense_item_id: expense_item.id)
@movements_global_amount_by_expense_items.keys.second
time_range
c
@movements_global_amount_by_expense_items[expense_item]['total'] = @movements_global_amount_by_expense_items[expense_item]['total'] + global_amount_by_expense_items
@movements_global_amount_by_expense_items[expense_item][@year.present? ? italian_month(time_range) : time_range]
@movements_global_amount_by_expense_items[expense_item][@year.present? ? italian_month(time_range) : time_range] = global_amount_by_expense_items
global_amount_by_expense_items
global_amount_by_expense_items = global_amount_by_expense_items * -1 if global_amount_by_expense_items < 0
global_amount_by_expense_items = movements.sum(&:amount).to_f.round(2)
movements.sum(&:amount).to_f.round(2)
movements.count
movements = @year.present? ? movements.where(month: time_range) : movements.where(year: time_range)
time_range
movements.count
movements = movements.where(expense_item_id: expense_item.id)
expense_item = @movements_global_amount_by_expense_items.keys.second
@movements_global_amount_by_expense_items.keys.second
@movements_global_amount_by_expense_items.keys.first
@movements_global_amount_by_expense_items.values
@movements_global_amount_by_expense_items.keys
params
Movement.count
movements.count
c
@movements_global_amount_by_expense_items.values
@movements_global_amount_by_expense_items
c
@movements_global_amount_by_expense_items
c
@grouped_count_final_amounts
c
time_ranges
c
@year
c
time_ranges
c
@month
@year
@time_range_report
c
to_date.day == to_date.end_of_month.day
from_date.day == from_date.beginning_of_year.day
check
c
@month
@year
@time_range_report
c
self.movements_path_by_month(year.to_i - 1, 1)
month.nil?
month
year
c
movements_list_links
c
@time_range_report
c
@time_range_report
c
to_date.day == to_date.end_of_month.day
from_date.day == from_date.beginning_of_month.day
from_date_month == to_date_month
check
q
params[:q][:emitted_at_gteq].split('-').
params[:q][:emitted_at_gteq].split('-')
c
date
c
q[:emitted_at_lteq].split('-')[2].to_i
q[:emitted_at_lteq].split('-')[1].to_i
q[:emitted_at_lteq].split('-')[0].to_i
q[:emitted_at_gteq].split('-')[2].to_i
q[:emitted_at_gteq].split('-')[1].to_i
q[:emitted_at_gteq].split('-')[0].to_i
c
q[:emitted_at_lteq]
q[:emitted_at_gteq]
c
params
q[:emitted_at_lteq]
c
q[:emitted_at_gteq].split('-')[0]
c
q[:emitted_at_gteq].split('-')[0]
q[:emitted_at_gteq]
c
q[:emitted_at_gteq]
Date.new(q[:emitted_at_gteq])
q[:emitted_at_gteq]
c
year
c
month
year
c
params[:q]
c
italian_months_for_select
c
@search.year_eq
@search.month_eq
@search
c
params[:q]
params
c
@movements_global_amount_by_expense_items[expense_item]
@movements_global_amount_by_expense_items[expense_item].delete('total')
@movements_global_amount_by_expense_items
@movements_global_amount_by_expense_items[expense_item].delete('total')
@movements_global_amount_by_expense_items[expense_item]
c
@movements_max_amount
c
@movements_global_amount_by_expense_items.sort_by{ | expense_item, hash | hash['total'] }.keys
@movements_global_amount_by_expense_items
@movements_global_amount_by_expense_items.keys
c
@movements_global_amount_by_expense_items[expense_item]
@movements_global_amount_by_expense_items
@movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }
@movements_global_amount_by_expense_items
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }[@movements_global_amount_by_expense_items.keys[-2]]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.fourth
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
c
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
c
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
c
-0.0 * -1
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
@movements_global_amount_by_expense_items[expense_item]
c
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
c
@movements_global_amount_by_expense_items[expense_item]
expense_item = @movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
@movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }.last
@movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }
c
@movements_global_amount_by_expense_items.keys.sort_by{ | expense_item, hash | expense_item.description }
@movements_global_amount_by_expense_items.sort_by{ | expense_item, hash | expense_item.description }.keys.pluck
@movements_global_amount_by_expense_items.keys
c
causal
c
causal
c
causal
c
f
causal
c
movement_type
amount
emitted_at
expired_at
causal
q
color_hex
expense_items_by_colors
expense_item_id
expense_item_id: expense_item_id
color_hex
causal
c
causal
color_hex
q
c
color_hex
c
file_paths.filter{ | file | file.include?('xlsx')}
file_paths
c
color_hex = fill_color[2..-1]
fill_color = workbook.stylesheet.fills[fill_id].pattern_fill&.fg_color&.rgb
workbook.stylesheet.fills[fill_id].pattern_fill&.fg_color&.rgb
fill_id = cell_style&.fill_id
cell_style = workbook.stylesheet.cell_xfs[ruby_cell.style_index]
cell_style = workbook.stylesheet.cell_xfs[style_index]
style_index = ruby_cell.style_index
cell_style = workbook.stylesheet.cell_xfs[style_index]
ruby_cell.style_index
c
cell.inspect
cell.get_cell_border
cell.get_cell_xf
cell.value_container
cell.ph
cell.vm
cell.vn
cell.r
